<!DOCTYPE html>
<html>

<head>
  <title>Genres â€¢ Library Management System</title>
  <%- include('./partials/head.ejs') %>
    <script src="/js/common.js"></script>
</head>

<body>
  <%- include('./partials/navbar.ejs', {user: user}) %>
    <div class="container-fluid mt-5">
      <h2 class="p-3 text-center">Genres</h2>
      <div class="list-group">
        <div class="row px-3 py-1 w-100">
          <span class="col py-1 bg-noroff">Id</span>
          <span class="col py-1 bg-noroff">Genre</span>
          <span class="col py-1 bg-noroff">Options</span>
        </div>
        <div id="genres-results"></div>
            <hr>
            <div class="row">
              <div class="col-4"></div>
              <div class="col-4 text-center mt-2">
                <form action="/genres/add" method="POST" class="d-flex gap-2 justify-content-center">
                  <input class="form-control" type="text" name="name" placeholder="Genre name" required>
                  <button class="btn btn-success" id="btn-add-genre">Add New Genre</button>
                </form>
              </div>
              <div class="col-4"></div>
            </div>
      </div>
    </div>
    <script>
      fetch('/genres/list', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      })
      .then((response) => response.json())
      .then((data) => {
        const container = document.getElementById('genres-results');
        container.innerHTML = '';
        (data.genres || []).forEach((item) => {
          const row = document.createElement('div');
          row.className = 'row px-3 py-1 w-100';
          row.innerHTML = `
            <span class="col py-1 bg-light">${item.id}</span>
            <span class="col py-1 bg-light">${item.name}</span>
            <span class="col py-1 bg-light text-center">
              <button class="btn-sm btn-warning" onclick="updateGenre(${item.id})">Update Genre</button>
              <button class="btn-sm btn-danger" onclick="deleteGenre(${item.id})">Delete Genre</button>
            </span>
          `;
          container.appendChild(row);
        });
      })
      .catch((error) => console.error('Error loading genres:', error));
    </script>
</body>

</html>
